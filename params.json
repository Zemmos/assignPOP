{
  "name": "assignPOP",
  "tagline": "Genetic or genomic population assignment under supervised machine learning framework",
  "body": "### Introduction\r\nRecent advances in next-generation sequencing techniques allow genome-wide loci to be vastly discovered for population ecology studies in both model and non-model species. To more efficiently analyze large genomic data for population assignment, we have developed an R package, *assignPOP*, to help perform population assignment tests and understand whether the collected data can be used to build a robust predicting model. We employ several machine learning methods to the package, including Monte-Carlo and K-fold cross-validation, PCA dimensionality reduction, and a variety of machine learning estimators for building predicting models. Not only our methodology helps speed up the analyses but prevents upwardly biased results that could occur when using some other programs (see Anderson 2010).    \r\n\r\n### Monte-Carlo cross-validation\r\nWe use Monte-Carlo (or K-fold) cross-validation as the framework to perform assignment tests. It assigns arbitrary proportions (or fixed numbers) of individuals from each population to the training set and the remaining to the test set. Next, if locus FST priority is preferred, the loci will be sorted by the FST values estimated based on the training set, and subsetted by the proportions (e.g., top 5% or 50% high FST loci). If not, the loci will be randomly subsetted. Next, PCA is performed on the training data, and the principal components (PCs) will be used as new variables for both training and test individuals. Afterward, a predicting model is built using the training set and then tested on the test set. Here, we provide several machine learning estimators, including linear discriminant analysis (LDA), support vector machine (SVM), naive Bayes (NB), decision tree (DT), and random forest (RF), to build predicting models. Once a test is completed, the program will resample the training individuals and repeat the process. Multiple levels of training sample size and iterations can be implemented in one single run, using the function *assign.MC()*. \r\n![MCCV framework](https://raw.githubusercontent.com/alexkychen/assignPOP/master/pic/Figure%201.%20Monte-Carlo%20cross-validation.png)\r\n\r\n### K-fold sampling \r\nTo ensure that every individual was assigned to the test set once, we include K-fold cross-validation (*assign.kfold()*) to complement the Monte-Carlo method. Unlike the Monte-Carlo sampling, the K-fold divides the individuals of each population into a number (K) of folds and uses one fold of the populations as the test set (the remaining are the training set) to a perform assignment test until every fold was tested. As such, the results of K-fold cross-validation can help us visualize the membership probability for every individual.     \r\n![K-fold sampling](https://raw.githubusercontent.com/alexkychen/assignPOP/master/pic/Figure%202.%20K-fold%20sampling.png)\r\n\r\n### Data conversion and dimension reduction\r\nTo read genetic data, we developed the function *read.genpop()* that allows users to import a Genepop format file into R. The function converts genotypic data to numeric that is also used in other programs (e.g, adegenet, Jombart 2008).  Each allele is encoded with 0 (absence), 0.5 (heterozygote), or 1 (homozygote). For example, if one locus has two alleles, A and T, the numeric data for three different genotypes are as follows.\r\n\r\n  |Genotype| |allele A|allele T\r\n----|----|----|----|----\r\nIndividual 1   | AA | | 1 | 0\r\nIndividual 2   | AT |=> | 0.5 | 0.5 \r\nIndividual 3   | TT | | 0 | 1\r\n\r\nIf a locus has only one allele across samples, the locus will be automatically disregarded. In addition, users can also combine genetic data with non-genetic data, such as morphometry or biogeochemistry, using the function *compile.data()*.\r\nWhen analyzing a large genomic dataset, the number of variables are often too large to be computed in a regular desktop computer. Even with a small subset of loci (e.g., 2,000 SNPs), using an ensemble method like random forest to create a predicting model could still be problematic. Therefore, to reduce data dimension, we applied PCA that can convert a great number of allele variables to considerably fewer PCs. The eigenvalues and eigenvectors are estimated using correlation matrix so that data will be standardized if other non-genetic data with different ranges of numbers were used. The loadings of selected PCs (estimated based on the training data) are used to calculate the scores (coordinates) for both training and test individuals. This PCA is internally performed when running the function *assign.MC()* or *assign.kfold()*, and it, by default, retains the PC that has an eigenvalue greater than 1 (the Kaiser-Guttman criterion). Users can also specify a certain number of PCs to be retained in the function's argument.  \r\n\r\n### Data visualization for correct assignment rate and membership probability\r\nThe correct assignment rates of test individuals across the tests can be estimated and visualized using a box plot. After the Monte-Carlo or K-fold cross-validation is completed, we can use the function *assign.rate.MC()* or *assign.rate.kfold()* to calculate correct assignment rates. The predicting population of a test individual is determined by the highest membership probability. We then can use *car.plot()* to create a box plot of correct assignment rates across the tests. In addition, the results of membership probability based on the K-fold cross-validation can be visualized using a stacked-bar plot (similar to the STRUCTURE output). We cannot use the Monte-Carlo cross-validation results because of the following reasons. First, it is possible that certain individuals are not used as test individuals when using the Monte-Carlo cross-validation. Second, the membership probability of an individual may vary from one test to another because of different sets of training individuals. We can use *prob.plot()* to create such membership probability plot.\r\n\r\n### Authors and Contributors\r\n\r\n\r\n### References\r\n* Anderson, E. C. 2010. Assessing the power of informative subsets of loci for population assignment: standard methods are upwardly biased. Molecular Ecology Resources 10:701â€“710.\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}