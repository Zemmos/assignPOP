<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>assignPOP by alexkychen</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">assignPOP</h1>
      <h2 class="project-tagline">Genetic or genomic population assignment under supervised machine learning framework</h2>
      <a href="https://github.com/alexkychen/assignPOP" class="btn">View on GitHub</a>
      <a href="https://github.com/alexkychen/assignPOP/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/alexkychen/assignPOP/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h3>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h3>

<p>Recent advances in next-generation sequencing techniques allow genome-wide loci to be vastly discovered for population ecology studies in both model and non-model species. To more efficiently analyze large genomic data for population assignment, we have developed an R package, <em>assignPOP</em>, to help perform population assignment tests and understand whether the collected data can be used to build a robust predicting model. We employ several machine learning methods to the package, including Monte-Carlo and K-fold cross-validation, PCA dimensionality reduction, and a variety of machine learning estimators for building predicting models. Not only our methodology helps speed up the analyses but prevents upwardly biased results that could occur when using some other programs (see Anderson 2010).    </p>

<h3>
<a id="monte-carlo-cross-validation" class="anchor" href="#monte-carlo-cross-validation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Monte-Carlo cross-validation</h3>

<p>We use Monte-Carlo (or K-fold) cross-validation as the framework to perform assignment tests. It assigns arbitrary proportions (or fixed numbers) of individuals from each population to the training set and the remaining to the test set. Next, if locus Fst priority is preferred, the loci will be sorted by the Fst values estimated based on the training set, and subsetted by the proportions (e.g., top 5% or 50% high Fst loci). If not, the loci will be randomly subsetted (e.g., random 5% of loci). Next, PCA is performed on the training data, and the principal components (PCs) will be used as new variables for both training and test individuals. Afterward, a predicting model is built using the training set and then tested on the test set. Here, we provide several machine learning estimators, including linear discriminant analysis (LDA), support vector machine (SVM), naive Bayes (NB), decision tree (DT), and random forest (RF), for building predicting models. Once a test is completed, the program will resample the training individuals and repeat the process. Multiple levels of training sample size and iterations can be implemented in one single run, using the function <em>assign.MC</em>. </p>

<p><img src="https://raw.githubusercontent.com/alexkychen/assignPOP/master/pic/Figure%201.%20Monte-Carlo%20cross-validation.png" alt="MCCV framework"></p>

<h3>
<a id="k-fold-sampling" class="anchor" href="#k-fold-sampling" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>K-fold sampling</h3>

<p>To ensure that every individual was assigned to the test set once, we include K-fold cross-validation (<em>assign.kfold</em>) to complement the Monte-Carlo method. Unlike the Monte-Carlo sampling, the K-fold divides individuals of each population into a number (K) of folds and uses one fold of the populations as the test set (the remaining are the training set) to perform assignment tests until every fold was tested. As such, we can use the K-fold cross-validation results to make a membership probability plot.  </p>

<p><img src="https://raw.githubusercontent.com/alexkychen/assignPOP/master/pic/Figure%202.%20K-fold%20sampling.png" alt="K-fold sampling"></p>

<h3>
<a id="data-conversion-and-dimension-reduction" class="anchor" href="#data-conversion-and-dimension-reduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Data conversion and dimension reduction</h3>

<p>To read genetic data, we developed the function <em>read.genpop</em> that allows users to import a Genepop format file into R. The function converts genotypic data to numeric that is also used in other programs (e.g, adegenet, Jombart 2008). Each allele is encoded with 0 (absence), 0.5 (heterozygote), or 1 (homozygote). For example, if one locus has two alleles, A and T, the numeric data for three different genotypes are as follows.</p>

<table>
<thead>
<tr>
<th></th>
<th>Genotype</th>
<th></th>
<th>allele A</th>
<th>allele T</th>
</tr>
</thead>
<tbody>
<tr>
<td>Individual 1</td>
<td>AA</td>
<td></td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>Individual 2</td>
<td>AT</td>
<td>=&gt;</td>
<td>0.5</td>
<td>0.5</td>
</tr>
<tr>
<td>Individual 3</td>
<td>TT</td>
<td></td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>If a locus has only one allele across samples, the locus will be automatically disregarded. In addition, users can also combine genetic data with non-genetic data, such as morphometry or biogeochemistry, using the function <em>compile.data</em>.</p>

<p>When analyzing a large genomic dataset, the number of variables are often too large to be computed in a regular desktop computer. Even with a small subset of loci (e.g., 2,000 SNPs), using an ensemble method like random forest to create a predicting model could still be problematic. Therefore, to reduce data dimension, we applied PCA that can convert a great number of allele variables to considerably fewer PCs. The eigenvalues and eigenvectors are estimated using correlation matrix so that data will be standardized if other non-genetic data with different ranges of numbers were used. The loadings of selected PCs (estimated based on the training data) are used to calculate the scores (coordinates) for both training and test individuals. This PCA is internally performed when running the function <em>assign.MC</em> or <em>assign.kfold</em>, and it, by default, retains the PC that has an eigenvalue greater than 1 (the Kaiser-Guttman criterion). Users can also specify a certain number of PCs to be retained in the function's argument.  </p>

<h3>
<a id="data-visualization-for-correct-assignment-rate-and-membership-probability" class="anchor" href="#data-visualization-for-correct-assignment-rate-and-membership-probability" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Data visualization for correct assignment rate and membership probability</h3>

<p>The correct assignment rates of test individuals across the tests can be estimated and visualized using a box plot. After the Monte-Carlo or K-fold cross-validation is completed, we can use the function <em>assign.rate.MC</em> or <em>assign.rate.kfold</em> to calculate correct assignment rates. The predicting population of a test individual is determined by the highest membership probability. We then can use <em>car.plot</em> to create a box plot of correct assignment rates across the tests. In addition, the results of membership probability based on the K-fold cross-validation can be visualized using a stacked-bar plot (similar to the STRUCTURE output). We cannot use the Monte-Carlo cross-validation results because of the following reasons. First, it is possible that certain individuals are not used as test individuals when using the Monte-Carlo cross-validation. Second, the membership probability of an individual may vary from one test to another because of different sets of training individuals. We can use <em>prob.plot</em> to create such membership probability plot.</p>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<h3>
<a id="references" class="anchor" href="#references" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>References</h3>

<ul>
<li>Anderson, E. C. 2010. Assessing the power of informative subsets of loci for population assignment: standard methods are upwardly biased. Molecular Ecology Resources 10:701–710.</li>
<li>Jombart, T. 2008. adegenet: a R package for the multivariate analysis of genetic markers. Bioinformatics 24:1403–1405.</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/alexkychen/assignPOP">assignPOP</a> is maintained by <a href="https://github.com/alexkychen">alexkychen</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
